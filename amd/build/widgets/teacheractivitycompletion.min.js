/**
 * Teacher activity completion line chart widget with AJAX filter.
 *
 * @module     report_lmsace_reports/widgets/teacheractivitycompletion
 * @copyright  2023 LMSACE <https://lmsace.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("report_lmsace_reports/widgets/teacheractivitycompletion",["jquery","core/ajax","core/loadingicon","core/chartjs"],(function($,AJAX,LoadIcon){var completionChart=null,loadiconElement=$(".teacher-activitycompletion-block .loadiconElement");return{init:function(main){if("undefined"==typeof teacheractivitycompletion)return null;var labels=teacheractivitycompletion.label,datavalue=teacheractivitycompletion.value;return function(main,labels,datavalue){var ctx=document.getElementById("teacher-activitycompletion-chart");if(ctx){var bgColor=main.getRandomColors(["c6"],"0.5",!0),borderColor=main.getRandomColors(["c6"]),customConfig={data:{datasets:[{label:"Activity completions"}]}};completionChart=main.buildChart(ctx,"line",labels,datavalue,bgColor,customConfig,borderColor)}}(main,labels,datavalue),$(".teacher-activitycompletion-block .dropdown-menu a").click((function(){var selText=$(this).text(),filter=$(this).attr("value");$(this).parents(".dropdown").find("#daterangefiltermenu").html(selText+' <span class="caret"></span>'),function(filter){filter||(filter="year");var request={methodname:"report_lmsace_reports_get_chart_reports",args:{filter:filter,chartid:"teacheractivitycompletionwidget",relatedid:teacheractivitycompletion.teacherid}},promise=AJAX.call([request])[0];promise.done((function(result){completionChart.data.labels=result.label,completionChart.data.datasets[0].data=result.value,completionChart.update()})),LoadIcon.addIconToContainerRemoveOnCompletion(loadiconElement,promise)}(filter)})),!0}}}));
